schemaVersion: '3.0.0'

backendResources:
  cpu: 3
  memoryMiB: 1024
  maxInstances: 4
  concurrency: 100

env:
  # Simple mapping from env var to value. By default will be applied with BUILD and BACKEND availability
  - variable: MY_ENV_VAR
    value: helloworld

  # Same as the above but with user specified availability
  - variable: STORAGE_BUCKET
    value: mybucket.appspot.com
    availability:
      - BUILD
      - BACKEND

  # This maps an env var to a secret that will need to be dereferenced via API call to secret manager.
  # Applied with the default BUILD and BACKEND availability
  - variable: API_KEY
    secret: myApiKeySecret # Key name in secret manager. Shorthand for pinning a build to the latest available version(regardless of active status) as of the time of the Build creation.
    availability:
      - BUILD

  # Same as API_KEY above but with a pinned version. See go/firestack-secrets for more information on this format.
  - variable: PINNED_API_KEY
    secret: myApiKeySecret@5 # Secret will be pinned to version 5

  # Same as API_KEY above but with the long form secret reference as defined by secret manager.
  - variable: VERBOSE_API_KEY
    secret: projects/test-project/secrets/secretID

  # Same as API_KEY above but with the long form secret reference w/ pinned version as defined by secret manager.
  - variable: PINNED_VERBOSE_API_KEY
    secret: projects/test-project/secrets/secretID/versions/5